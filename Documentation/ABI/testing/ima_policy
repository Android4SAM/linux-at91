What:		security/ima/policy
Date:		May 2008
Contact:	Mimi Zohar <zohar@us.ibm.com>
Description:
		The Trusted Computing Group(TCG) runtime Integrity
		Measurement Architecture(IMA) maintains a list of hash
		values of executables and other sensitive system files
		loaded into the run-time of this system.  At runtime,
		the policy can be constrained based on LSM specific data.
		Policies are loaded into security/ima/policy by opening
		the file, writing the rules one at a time and then
		closing the file.  The new policy takes effect after
		the security/ima/policy is closed.

		rule format: action [condition ...]

		action: measure | dont_measure
		condition:= base | lsm
			base:	[[func=] [mask=] [fsmagic=]]
			lsm:	[[subj=] [obj=] [type=]]

		base: 	func:= [BPRM_CHECK][FILE_MMAP][INODE_PERMISSION]
			mask:= [MAY_READ] [MAY_WRITE] [MAY_APPEND] [MAY_EXEC]
			fsmagic:= hex value
		lsm:  	are LSM specific

		default policy:
			# PROC_SUPER_MAGIC
			dont_measure fsmagic=0x9fa0
			# SYSFS_MAGIC
			dont_measure fsmagic=0x62656572
			# DEBUGFS_MAGIC
			dont_measure fsmagic=0x64626720
			# TMPFS_MAGIC
			dont_measure fsmagic=0x01021994
			# SECURITYFS_MAGIC
			dont_measure fsmagic=0x73636673

			measure func=BPRM_CHECK
			measure func=FILE_MMAP mask=MAY_EXEC
			measure func=INODE_PERM mask=MAY_READ

		The default policy measures all executables in bprm_check,
		all files mmapped executable in file_mmap, and all files
		open for read in inode_permission.

		Examples of LSM specific definitions:

		SELinux:
			dont_measure type=var_log_t
			dont_measure type=auditd_log_t
			measure subj=system_u func=INODE_PERM mask=MAY_READ

		Smack:
			measure subj=_ func=INODE_PERM mask=MAY_READ
